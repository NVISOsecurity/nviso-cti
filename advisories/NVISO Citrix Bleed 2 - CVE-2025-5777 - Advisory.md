## Summary Overview

Citrix Bleed 2 (CVE-2025-5777) is a critical vulnerability affecting Citrix NetScaler ADC and Gateway devices, disclosed on June 17, 2025. It involves insufficient input validation leading to memory overread, allowing attackers to access sensitive information such as authentication tokens and credentials. The vulnerability impacts several versions, including 14.1 and 13.1, and is actively exploited, enabling unauthorized access to sensitive memory contents, session hijacking, and bypassing multi-factor authentication. Immediate actions include patching affected systems, restricting access, and monitoring for exploitation signs to mitigate risks associated with this vulnerability.

## Citrix Bleed 2 - CVE-2025-5777

### DESCRIPTION

CVE-2025-5777, dubbed as Citrix Bleed 2 (CVSS v4.0: 9.3 - CRITICAL), originally disclosed on 17 June, is a vulnerability on Citrix NetScaler ADC and NetScaler Gateway which is about insufficient input validation leading to memory overread (CWE-125: Out-of-bounds Read). It affects NetScaler devices configured as a Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) or AAA virtual server. Successful exploitation gives attackers read access to sensitive information such as authentication tokens and credentials.

### AFFECTED CONFIGURATIONS

The following supported versions of NetScaler ADC and NetScaler Gateway are affected by the vulnerabilities:

- NetScaler ADC and NetScaler Gateway 14.1 BEFORE 14.1-43.56
- NetScaler ADC and NetScaler Gateway 13.1 BEFORE 13.1-58.32
- NetScaler ADC 13.1-FIPS and NDcPP BEFORE 13.1-37.235-FIPS and NDcPP
- NetScaler ADC 12.1-FIPS BEFORE 12.1-55.328-FIPS

NetScaler ADC and NetScaler Gateway versions 12.1 and 13.0 are now End Of Life (EOL) and are vulnerable.

Secure Private Access on-prem or Secure Private Access Hybrid deployments using NetScaler instances are also affected by the vulnerability.

Only customer-managed NetScaler ADC and Gateways are affected. Citrix-managed cloud services and Adaptive Authentication are automatically updated by Cloud Software Group.

### IMPACT

Exploitation of this vulnerability allows unauthenticated attackers to read sensitive memory contents, including authentication tokens. With these tokens, an attacker could hijack user sessions, bypass multi-factor authentication (MFA), and remain undetected for long periods across multiple systems, while conducting further reconnaissance inside the compromised environment. In some cases, attackers have been able to extract session tokens belonging to the nsroot user, granting access to the entire Citrix NetScaler ADC instance.

### TECHNICAL DETAILS

The vulnerability involves Citrix NetScaler's handling of HTTP request data, particularly in the nsppe binary (NetScaler Packet Parsing Engine). This module is responsible for managing NetScaler Gateway features, AAA authentication mechanisms, and other functionalities.

The key issue arises in the processing of login requests to the `/p/u/doAuthentication.do` endpoint. This endpoint reflects user-supplied login values in its response, regardless of whether the request succeeds or fails. The vulnerability allows attackers to exploit this behavior by crafting requests with partially constructed or missing form values. When the request data is parsed, the backend doesn’t safely zero out or initialize the corresponding memory. This enables attackers to leak up to 127 bytes of arbitrary data, potentially including session tokens or other sensitive information.

The leaked data can be captured by repeatedly polling the vulnerable endpoint. This issue is compounded by the fact that the same memory space is used by configuration utilities for managing NetScaler Gateway endpoints, making administrative tokens vulnerable to theft as well.

### EXPLOITATION STATUS

Citrix Bleed 2 has been under active exploitation globally for a month even though Citrix denies it. On 10th of July, CISA added CVE-2025-577 to the Known Exploited Vulnerability (KEV) catalogue.
Researchers have already released proof-of-concept (PoC) exploits for Citrix Bleed 2.


Security researchers from ReliaQuest have already observed real-world signs of exploitation, including:

- Hijacked Citrix web session from the NetScaler device also bypassing the MFA flows.
- Session reuse across multiple suspicious IPs.
- LDAP queries associated with Active Directory reconnaissance activities.
- Multiple instances of the ADExplorer64.exe tool across the environment, querying domain-level groups and permissions and moving laterally to multiple domain controllers.

All these activities are indicators that cyber criminals & ransomware groups,  are weaponizing this vulnerability as of now.
Almost a month in after disclosure, approximately 500 of the affected organizations still haven’t applied the required patches according to ShadowServer Foundation.


### SIMILARITIES AND DIFFERENCES TO CVE-2023-4966 (CITRIX BLEED)

In 2023, the vulnerability dubbed Citrix Bleed became well-known for its considerable impact on Citrix NetScaler ADC and Gateway devices. This security flaw enabled attackers to retrieve session cookies from memory, allowing them to circumvent MFA and take control of user sessions. Ransomware groups and advanced persistent threat (APT) actors exploited this vulnerability extensively, penetrating networks, moving laterally, and causing disruptions with remarkable accuracy. Although Citrix issued patches to mitigate the vulnerability, numerous systems remained exposed due to outdated devices and inadequate session termination practices. Even today, Citrix Bleed continues to be exploited by threat actors, demonstrating that this security issue is still active and relevant.

Similar to its predecessor, Citrix Bleed 2 allows attackers to extract authentication information from memory. However, this iteration utilizes out-of-bounds memory reads to capture authentication tokens rather than session cookies. Unlike session cookies, which are generally associated with short-lived browser sessions, session tokens are often employed in more extensive authentication frameworks, including API calls or persistent application sessions. As a result, attackers could potentially sustain access for longer periods and operate across multiple systems undetected, even after the user has ended the browser session.

### MITIGATION AND RECOMMENDATIONS

#### Prioritize Patching

It is strongly suggested for affected customers of NetScaler ADC and NetScaler Gateway to install the relevant updated versions as soon as possible.

- NetScaler ADC and NetScaler Gateway 14.1-43.56 and later releases
- NetScaler ADC and NetScaler Gateway 13.1-58.32 and later releases of 13.1
- NetScaler ADC 13.1-FIPS and 13.1-NDcPP 13.1-37.235 and later releases of 13.1-FIPS and 13.1-NDcPP
- NetScaler ADC 12.1-FIPS 12.1-55.328 and later releases of 12.1-FIPS

As mentioned, NetScaler ADC and NetScaler Gateway versions 12.1 and 13.0 are now EOL and no longer supported. Customers are recommended to upgrade their appliances to one of the supported versions that address the vulnerabilities.

#### Decrease the Attack Surface

- Build network access control lists (ACLs) or firewall rules to limit access to vulnerable servers until patches are applied.
- Identify any externally facing Citrix infrastructure. Prioritize these for access restriction and patching.

#### Monitor and Kill Active Sessions

As soon as all appliances have been updated, admins should first review active sessions for suspicious activity using the `show icaconnection` command and NetScaler Gateway > PCoIP > Connections from the GUI. Then, it is recommended running the following commands to terminate all active ICA and PCoIP sessions after all NetScaler appliances in the HA pair or cluster have been upgraded to the fixed builds:

```plaintext
kill icaconnection -all
kill pcoipConnection -all
```

#### Exploitation Requests

- If Netscaler web access logs exist in a SIEM, look for an excessive number of requests to a URI including “doAuthentication.do”.
- In Netscaler web access logs, monitor for requests to `doAuthentication.do` endpoint with “Content-Length: 5” in the headers, since the exploit is triggered also by sending the login request with just “login” as the payload.
- In Netscaler user logs, search for lines with `*LOGOFF*` and `user = "*#*"` (i.e. # symbol in the username).
- Search for log entries with non-printable characters.

#### Configurations Baseline Check

In terms of post-exploitation activities, similar TTPs are expected from the threat actors exploiting the original Citrix Bleed like adding backdoor accounts and dumping and modifying the running configurations with persistence mechanisms. If configuration backups are available, it is suggested to display the current running configuration using the command `show ns runningConfig -withDefaults` and compare it to a known good backup using a diffing utility, such as `diff -u backup.config current.config` to check for suspicious configuration changes.

#### Same Session ID Multiple IP addresses

To identify potential abuse of the vulnerability, monitor the use of session IDs across different IP addresses. Attackers who have exploited these vulnerabilities may leverage the obtained information to connect to the appliances using compromised session IDs.

#### Indicators of Compromise

Perform a retro hunt for the following IoCs provided by GreyNoise:

- `91[.]219[.]238[.]78`
- `78[.]128[.]113[.]30`
- `92[.]38[.]162[.]11`
- `88[.]214[.]26[.]30`
- `80[.]209[.]243[.]221`
- `121[.]237[.]80[.]248`
- `185[.]217[.]69[.]124`
- `38[.]244[.]138[.]83`
- `64[.]176[.]50[.]109`
- `38[.]154[.]237[.]100`
- `102[.]129[.]235[.]108`
- `121[.]237[.]80[.]241`
- `45[.]135[.]232[.]2`

## REFERENCES

- [ReliaQuest Blog](https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/)
- [DoublePulsar](https://doublepulsar.com/citrixbleed-2-exploitation-started-mid-june-how-to-spot-it-f3106392aa71)
- [GreyNoise](https://viz.greynoise.io/query/tags:%22CitrixBleed%202%20CVE-2025-5777%20Attempt%22%20last_seen:90d)
- [Citrix Support](https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420)
- [Horizon3.ai](https://horizon3.ai/attack-research/attack-blogs/cve-2025-5777-citrixbleed-2-write-up-maybe/)
- [Gibraltar Solutions](https://gibraltarsolutions.com/blog/citrix-bleed-2-what-it-teams-need-to-know-and-do-now/)
- [WatchTowr Labs](https://labs.watchtowr.com/how-much-more-must-we-bleed-citrix-netscaler-memory-disclosure-citrixbleed-2-cve-2025-5777/)
- [NetScaler Blog](https://www.netscaler.com/blog/news/netscaler-critical-security-updates-for-cve-2025-6543-and-cve-2025-5777/)
- [Censys Advisory](https://censys.com/advisory/cve-2025-5777-cve-2025-6543-cve-2025-5439)
- [Arctic Wolf](https://arcticwolf.com/resources/blog-uk/cve-2025-5777-critical-information-disclosure-vulnerability-citrix-bleed-2-in-citrix-netscaler-adc-and-gateway/)
- [Bleeping Computer](https://www.bleepingcomputer.com/news/security/public-exploits-released-for-citrixbleed-2-netscaler-flaw-patch-now/)
- [ShadowServer Statistics](https://dashboard.shadowserver.org/statistics/combined/time-series/?date_range=other_range&d1=2025-05-31&d2=2025-07-09&source=http_vulnerable&source=http_vulnerable6&tag=cve-2025-5777%2B&dataset=unique_ips&limit=100&group_by=tag&stacking=overlap&auto_update=on)
- [CISA Alert](https://www.cisa.gov/news-events/alerts/2025/07/10/cisa-adds-one-known-exploited-vulnerability-catalog)
- [PoC](https://github.com/RickGeex/CVE-2025-5777-CitrixBleed/blob/main/README.md)
